<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>검색 결과 - 뷰티 코스메틱 쇼핑몰</title>
    <link rel="stylesheet" href="styles/styles.css">
    <script src="scripts/global.js"></script>
    <script src="scripts/include.js"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
    </script>
    <script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="85be34eb-e45a-4f84-8c82-62f3e3578f89" data-blockingmode="auto" data-consentmode="disabled" type="text/javascript"></script>
</head>
<body>
    <div include-html="components/header.html"></div>
    <main class="main-content">
        <h2>검색 결과</h2>
        <div class="products" id="searchResults">
            <!-- 검색 결과가 여기에 표시됩니다. -->
        </div>
    </main>
    <div include-html="components/footer.html"></div>

    <!-- 스크립트 로드 -->
    <script src="scripts/user.js"></script>
    <script src="scripts/product.js"></script>
    <script>
        async function initializePage() {
            await window.loadProductData();
            window.checkAuthStatus();
            window.addEventListeners();
            const urlParams = new URLSearchParams(window.location.search);
            const query = urlParams.get('query');
            if (query) {
                const searchInput = document.getElementById('searchInput');
                if (searchInput) searchInput.value = query;
                performSearch(query); 
            }
        }
        includeHTML(initializePage);

        function performSearch(query) {
            const searchResults = document.getElementById('searchResults');
            searchResults.innerHTML = '검색 중...';

            const results = window.products.filter(product => 
                product.name.toLowerCase().includes(query.toLowerCase()) ||
                (product.description && product.description.toLowerCase().includes(query.toLowerCase()))
            );

            if (results.length > 0) {
                searchResults.innerHTML = results.map(product => `
                    <div class="product-item" onclick="window.viewProduct(${product.id})">
                        <img src="${product.image}" alt="${product.name}">
                        <h3>${product.name}</h3>
                        <p>${product.price.toLocaleString()}원</p>
                    </div>
                `).join('');
            } else {
                searchResults.innerHTML = '검색 결과가 없습니다.';
            }
        }
    </script>
</body>
</html>
